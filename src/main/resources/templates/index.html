<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–µ–π—Ä–æ-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
    <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body>
<div class="container">
    <h1>ü§ñ –ù–µ–π—Ä–æ-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</h1>

    <form th:action="@{/generate}" method="post">
        <div class="form-group">
            <label for="systemContext">–°–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:</label>
            <textarea
                    id="systemContext"
                    name="systemContext"
                    rows="3"
                    cols="50"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–∞ Java. –û—Ç–≤–µ—á–∞–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω–æ –∏ –∫—Ä–∞—Ç–∫–æ."
            >[[${systemContext}]]</textarea>
            <small>–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –º–æ–¥–µ–ª–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</small>
        </div>

        <div class="form-group">
            <label for="prompt">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å:</label>
            <textarea
                    id="prompt"
                    name="prompt"
                    rows="4"
                    cols="50"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ—á–µ–º—É –Ω–µ–±–æ —Å–∏–Ω–µ–µ?"
                    required
            >[[${prompt}]]</textarea>
        </div>

        <button type="submit">–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
    </form>

    <div class="response-section">
        <h2>–û—Ç–≤–µ—Ç:</h2>
        <div class="response-box" id="responseBox">
            <p th:text="${response}" style="white-space: pre-line;"></p>
        </div>
    </div>

    <div class="api-info">
        <h3>API Endpoint:</h3>
        <p>POST /api/generate</p>
        <p>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):</p>
        <pre>{"prompt": "–≤–∞—à —Ç–µ–∫—Å—Ç", "systemContext": "–∫–æ–Ω—Ç–µ–∫—Å—Ç"}</pre>
    </div>
</div>

<script>
    // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ AJAX
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');

        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault();

                const prompt = document.getElementById('prompt').value;
                const systemContext = document.getElementById('systemContext').value;
                const responseBox = document.getElementById('responseBox');

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                responseBox.innerHTML = '<p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</p>';

                fetch('/api/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        systemContext: systemContext
                    })
                })
                    .then(response => response.text())
                    .then(data => {
                        responseBox.innerHTML = '<p>' + data.replace(/\n/g, '<br>') + '</p>';
                    })
                    .catch(error => {
                        responseBox.innerHTML = '<p style="color: red;">–û—à–∏–±–∫–∞: ' + error.message + '</p>';
                    });
            });
        }
    });
</script>
</body>
</html>